{
	"version": "1.0",
	"meta": {
		"description": "Copilot Agent alignment profile for the Nodus Core system.",
		"maintainer": "Nodus Security Engineering Group",
		"last_updated": "2025-11-01"
	},

	"objectives": {
		"primary": [
			"Preserve compliance with Developer Mandates and Forensic Security Addendum.",
			"Maintain composability, modularity, and low coupling in all generated code.",
			"Ensure all code is deterministic, auditable, and compatible with offline-first operation.",
			"Automatically promote correct forensic envelopes, MAC enforcement, and cryptographic labeling in all state mutations."
		],
		"secondary": [
			"Assist with refactoring to modern ESM syntax and eliminate legacy imports.",
			"Support clear developer ergonomics while preserving full audit traceability.",
			"Encourage performance-safe async operations and constant-time security checks.",
			"Ensure all generated UI logic conforms to BindEngine and StateUIBridge patterns."
		]
	},

	"enforcement": {
		"mandatory_rules": [
			"All functions must include JSDoc with parameter and return type annotations.",
			"All state mutations must be wrapped in forensic envelopes via ForensicLogger.",
			"All async operations must be executed through AsyncOrchestrationService.createRunner (or an injected orchestrator.wrap/run) rather than raw async functions.",
			"Imports must use canonical aliases (e.g. '@shared/...') or explicit file paths with extensions; no index barrels or legacy shims.",
			"All network calls must use SecureFetch wrapper (never raw fetch).",
			"All data-bound DOM updates must pass through BindEngine or StateUIBridge.",
			"No usage of innerHTML, eval, Function(), or unescaped template literals."
		],
		"lint_integrations": [
			"nodus/prefer-alias-imports",
			"nodus/require-async-orchestration",
			"copilotGuard/require-jsdoc-and-tests",
			"copilotGuard/require-forensic-envelope",
			"copilotGuard/no-insecure-api"
		]
	},

	"contextual_guidelines": {
		"core": {
			"StorageLoader.js": "Promote modular, data-driven loading; never hardcode module lists.",
			"HybridStateManager.js": "Preserve reactive, event-driven sync between domains.",
			"ComposableSecurity.js": "Always call MAC.enforceNoWriteDown() and MAC.enforceNoReadUp() before writes/reads.",
			"AsyncOrchestrationService.js": "Generate runners with AsyncOrchestrationService.createRunner for any orchestration-aware helpers; ensure metadata includes label prefixes and actor IDs.",
			"Project Imports": "Prefer '@' aliases with explicit filenames (e.g. '@shared/lib/SafeDOM.js'); fallback to relative paths only when pointing at a concrete file.",
			"ForensicLogger.js": "Every audit trail must include a classification label and cryptographic signature placeholder.",
			"BindEngine_v2.js": "Respect forensic logging for every DOM change; avoid direct state mutations."
		},
		"frontend": {
			"StateUIBridge.js": "Treat as the main reactive binding layer; never bypass it for UI updates.",
			"ComponentRegistry.js": "Encourage composable, declarative UI definitions; avoid imperative DOM manipulation.",
			"Grid System": "All render updates must be idempotent and forensic-logged."
		},
		"security": {
			"ClassificationCrypto.js": "Always encrypt classification-level data before persistence.",
			"Keyring.js": "Do not generate or export plaintext keys; use sealed secrets only.",
			"ct.js": "Use constantTimeCheck() around all access checks and equality comparisons.",
			"CrossDomainSolution.js": "Require dual approval and forensic ticketing before any downgrade."
		}
	},

	"testing": {
		"framework": "vitest",
		"requirements": [
			"Each new module must include a test suite in /tests/ that covers critical paths.",
			"Tests must validate forensic envelope creation and MAC enforcement.",
			"BindEngine and StateUIBridge modules must have DOM reactivity tests."
		],
		"disallow": [
			"unmocked network calls",
			"hardcoded secrets",
			"global mutable state"
		]
	},

	"security_addendum": {
		"classification": {
			"default": "UNCLASSIFIED",
			"levels": [
				"UNCLASSIFIED",
				"CONFIDENTIAL",
				"SECRET",
				"TOP_SECRET",
				"COSMIC_TOP_SECRET"
			]
		},
		"encryption": {
			"mandatory": true,
			"library": "ClassificationCrypto",
			"key_management": "InMemoryKeyring | HSM",
			"timing_protection": "constantTimeCheck() enforced globally"
		},
		"auditing": {
			"forensic_chain": true,
			"signature": "NonRepudiation.signAction()",
			"cross_domain_solution": "enabled"
		}
	},

	"documentation": {
		"requirement": "Every exported class or function must include a top-level JSDoc summary, usage example, and forensic note.",
		"ai_assist_behavior": {
			"refactor_mode": "Prefer pure functions and explicit dependencies.",
			"generate_mode": "Default to secure and auditable patterns (ForensicLogger, MAC enforcement, envelope wrapping).",
			"completion_style": "Descriptive, minimal boilerplate, inline JSDoc-first."
		}
	},

	"developer_guidance": {
		"philosophy": {
			"summary": "The system favors explicit, deterministic control over opaque abstractions. Frameworks exist only when they enforce security or audit traceability.",
			"principles": [
				"Composability over complexity",
				"Simplicity over convenience",
				"Auditability over speed",
				"Security over abstraction"
			]
		},
		"training_data_bias_protection": {
			"goal": "Avoid generic web-framework boilerplate. Copilot should align with Nodusâ€™ zero-framework, hybrid-kernel approach.",
			"disallow": [
				"React hooks",
				"Vue reactivity",
				"Angular directives",
				"global event buses"
			]
		}
	}
}
